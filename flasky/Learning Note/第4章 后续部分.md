## 4.5 重定向和用户会话
- 重定向是一种特殊的响应，响应内容包含的是URL，而不是HTML代码的字符串
- 浏览器收到这种响应时，会向重定向的URL发起GET请求，显示页面的内容

- 示例实现了重定向和用户会话：
    - 包含有效表单数据的请求最后会使试图函数调用redirect()函数
    - redirect()是Flask提供的辅助函数，用于生成HTTP重定向响应
    - redirect()函数的参数是重定向的URL
    - url_for()函数的第一个且唯一必须指定的参数是端点名，及路由的内部名称；默认情况下，路由的端点是相应试图函数的名称


    from flask import Flask, render_template, session, redirect, url_for
    
    @app.route('/',methods=['GET','POST'])
    def index():
        form = NameForm()
        if form.validate_on_submit():
            session['name'] = form.name.data
            return redirect(url_for('index'))
        return render_template('index.html',from=form,name=session.get('name'))

## 4.6 闪现消息
- 请求完成后，有时需要让用户知道状态发生了变化，可以是确认消息，警告或者错误提醒
- Flask本身内置这个功能

- 示例flash()函数可以实现这种效果


    # 闪现消息
    from flask import Flask,render_template,session,redirect,url_for,flash
    
    @app.route('/',methods=['GET','POST'])
    def index():
        form = NameForm()
        if form.validate_on_submit():
            old_name = session.get('name')
            if old_name is not None and old_name != from.name.data:
                flash('Looks like you have changed your name!')
            session['name'] = from.name.data
            return redirect(url_for('index'))
        return render_template('index.html',form=form,name=session.get('name'))

- 仅用flash()函数并不能吧消息显示出来，应用的模板必须渲染这些消息
- 最好在基模板中渲染闪现消息，因为这样所有页面都能显示需要显示的消息
- Flask把get_flashed_messages()函数开放给模板，用于获取并渲染闪现消息


    # templates/base.html:渲染闪现消息
    {% block content %}
    <div class="container">
        {% for message in get_flashed_messages() %}
        <div class="alert alert-warning">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            {{ message }}
        </div>
        {% endfor %}
        
        {% block page_content %}{% endblock %}
        
    </div>
    {% endblock%}

- 这个示例使用Bootstrap提供的CSS alert样式渲染警告消息
- 这里使用了循环，因为在之前的请求循环中每次调用flash()函数时都会生成一个消息，所以可能有多个消息在排队等待显示
- get_flashed_messages()函数获取的消息在下次调用时不会再次返回，因此闪现消息只显示一次，然后就消失了







